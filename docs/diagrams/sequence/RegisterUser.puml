@startuml Register User (POST)

header GoCamply Sequence Diagram
footer Page %page% of %lastpage%
title "Register User (POST)"

participant "Client" as client
participant "<<javaScript>>\n:server" as server
participant "<<router>>\n:auth" as routerAuth
participant "<<controllers>>\n:auth" as controllersAuth
participant "<<model>>\n:User" as modelUser
database "<<MongoDB>>\n:users" as UsersDatabase

client->server ++: req.post('/api/v1/auth/register') { name, telephone, email, password }
server->routerAuth ++: app.use('/api/v1/auth', auth)
routerAuth -> controllersAuth ++: register(req)
controllersAuth -> modelUser ++: create({ name, telephone, email, password, role })
modelUser -> UsersDatabase ++: insert user document
UsersDatabase --> modelUser --: user
controllersAuth <-- modelUser --: user
controllersAuth -> controllersAuth ++: sendTokenResponse(user)
controllersAuth -> client --: response 200 { success: true, _id, name, telephone, email, token }

note over controllersAuth: on error -> 400

@enduml
